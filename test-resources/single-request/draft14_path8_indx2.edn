;; from `rfc-response.path8.index2.4c16c619`

;; but the ROOT/PATH combination appears to be wrong:

;; (def path-bytes (-> "test-resources/single-request/draft14_path8_indx2.edn"
;;                     slurp
;;                     edn/read-string
;;                     :replies
;;                     first
;;                     u/hex-string->bytes
;;                     (packet/decode-packet {:min-size-bytes 0})
;;                     :message
;;                     (get "PATH")))

;; (def leaf-data (letfn [(h [x] (m/hash-leaf 32 x))]
;;                  (-> "test-resources/single-request/draft14_path8_indx2.edn"
;;                      slurp
;;                      edn/read-string
;;                      :request
;;                      first
;;                      u/hex-string->bytes)))

;; (def root-data (-> "test-resources/single-request/draft14_path8_indx2.edn"
;;                    slurp
;;                    edn/read-string
;;                    :replies
;;                    first
;;                    u/hex-string->bytes
;;                    (packet/decode-packet {:min-size-bytes 0})
;;                    :message
;;                    (tlv/decode-rt-message-recursive)
;;                    (get-in ["SREP" "ROOT"])))

;; (def nonc-data (-> "test-resources/single-request/draft14_path8_indx2.edn"
;;                    slurp
;;                    edn/read-string
;;                    :replies
;;                    first
;;                    u/hex-string->bytes
;;                    (packet/decode-packet {:min-size-bytes 0})
;;                    :message
;;                    (get "NONC")))

;; (-> root-data
;;     u/bytes->hex-string)
;; ;; => "1ecf2ead5837a00dc01d2875bdb16c2be094da36115dce7966e320e31345bb97"

;; (-> (m/reconstruct-root {:leaf-data leaf-data
;;                          :path-bytes path-bytes
;;                          :index 2}
;;                         {:hash-size 32
;;                          :tree-order :natural})
;;     u/bytes->hex-string)
;; ;; => "01b1e3a3584b93c006434cae232e912a10c519211248a40a86952006b615d79e"

;; (-> (m/reconstruct-root {:leaf-data leaf-data
;;                          :path-bytes path-bytes
;;                          :index 2}
;;                         {:hash-size 32
;;                          :tree-order :mirrored})
;;     u/bytes->hex-string)
;; ;; => "40df434b7141f5919b15276aa36c0feae689bb85c91fdc63a4cf0987e9274888"

;; (-> (m/reconstruct-root {:leaf-data nonc-data
;;                          :path-bytes path-bytes
;;                          :index 2}
;;                         {:hash-size 32
;;                          :tree-order :natural})
;;     u/bytes->hex-string)
;; ;; => "c26f7b7a095448df0e8cdc7f91aadfaeb8f010a189d15a52ac32d8aea95ffcb1"

;; (-> (m/reconstruct-root {:leaf-data nonc-data
;;                          :path-bytes path-bytes
;;                          :index 2}
;;                         {:hash-size 32
;;                          :tree-order :mirrored})
;;     u/bytes->hex-string)
;; ;; => "6ea0daeab225079e125e1f2f29f90a066b62a829f83335f92b714fcc18b6555f"



;; {:info       "draft-ietf-ntp-roughtime-14 1"
;;  :lt-pub     "016e6e0284d24c37c6e4d7d8d5b4e1d3c1949ceaa545bf875616c9dce0c9bec1"
;;  :online-pub "b9045bea9dccd4ba0c34181f5cf6994300d49b3b8611559518e01bbe66f9c583"
;;  :nonce      "4c16c619d7716fae49552b3393fd07cff4c6f16a1ab5a2f7ce5240f94a6d1f29"
;;  :resp-vers  [0x00 0x8000000c]
;;  :msg-len 1012
;;  :request ["524f55474854494df403000004000000040000002400000028000000564552004e4f4e43545950455a5a5a5a0c0000804c16c619d7716fae49552b3393fd07cff4c6f16a1ab5a2f7ce5240f94a6d1f290000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"]
;;  :replies ["524f55474854494d980200000700000040000000600000006400000064010000c40100005c020000534947004e4f4e4354595045504154485352455043455254494e445872c53051ad9773f484c6bdfd27e6595ce40a117ec3b86a41887b7135bd93f3238ef445939bd7d9c262f31e6a306ebeb41a4e436ef81ff21c8b9e0d3be22ae50a4c16c619d7716fae49552b3393fd07cff4c6f16a1ab5a2f7ce5240f94a6d1f29010000007148a705f7c562f0cb1f278aabca93133269453042eb8d554da4d6f0a1fbd7202cd76bb0939d911c623831205caef0602e9a62a115de2117a869eb3775a481edbb6f543d60a509f50560885423496fd085d0f2a63787b91d0ade26fdf3a6352807b417d43fbde735f33fbb36b7f8fa9cc68b6462e17629e88086ee8b7aefee74f8dd1237cf5b5d6ab8409278374639298404fd21561ba7caca142b9d0e5d574ec56a648e3393c8c612281516cea5af523660d40b3fe57141af51646b60b98a3a761ecd09f131bedf9ecf9c557d9b511b28a1e6c7950f854c3febc71b7f01d5f616d0ea810ac7d01f8c412203a49821bc4befa651e413b352fef04c97f1ef5730050000000400000008000000100000001800000056455200524144494d49445056455253524f4f540c0000800500000019d8356800000000000000000c0000801ecf2ead5837a00dc01d2875bdb16c2be094da36115dce7966e320e31345bb9702000000400000005349470044454c452df7d5397611739c683f54b95359b11781d079b28b09bcf13d42d85868db48b8bafcbf0492ca836f615d3d88775c455c9443368f959cb90644c7093430ed45020300000020000000280000005055424b4d494e544d415854254e5d6fa2453dac9931cb7ae84c4e2790a69b390bac8f68b332db0d1c7dd6c70000000000000000ffffffffffffffff02000000"]}
